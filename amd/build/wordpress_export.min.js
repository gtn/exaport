define("block_exaport/wordpress_export",["exports","jquery","core/toast","core/config","core/str"],(function(_exports,_jquery,_toast,_config,_str){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=function(){stringKeys=[{key:"wp_logged_in",component:"block_exaport"},{key:"wp_updated",component:"block_exaport"},{key:"wp_exported",component:"block_exaport"},{key:"wp_removed",component:"block_exaport"},{key:"wp_request_error",component:"block_exaport"},{key:"wp_request_error_code",component:"block_exaport"}],(0,_str.get_strings)(stringKeys).then((function(results){return strings.logged_in=results[0],strings.updated=results[1],strings.exported=results[2],strings.removed=results[3],strings.request_error=results[4],strings.request_error_code=results[5],!0})).fail((function(){strings.logged_in="Logged in",strings.updated="Updated",strings.exported="Exported",strings.removed="Removed",strings.request_error="Request error! ",strings.request_error_code="Request error (code: {$a})!"})),(0,_jquery.default)(document).on("click",".exaport-wp-login, .exaport-wp-loginUpdate",(function(e){e.preventDefault(),(0,_jquery.default)(".exaport-wp-error").remove();var theButton=(0,_jquery.default)(this),action="login",successMessage=strings.logged_in||"Logged in";theButton.hasClass("exaport-wp-loginUpdate")&&(action="loginUpdate",successMessage=strings.updated||"Updated"),buttonLoading(theButton,!0),wpRequest(action,[],(function(response){buttonLoading(theButton,!1),(response=JSON.parse(response).response).success&&(wpRequest("wpForm",[],(function(response){theButton.closest("form").html(response)})),(0,_toast.add)(successMessage,{type:"success",autohide:!0})),response.error&&(0,_toast.add)(response.message,{type:"danger",autohide:!1,closeButton:!0})}),(function(){buttonLoading(theButton,!1),(0,_toast.add)(strings.request_error_code.replace("{$a}","1745225660311")||"Error: 1745225660311",{type:"danger",autohide:!1,closeButton:!0})}))})),(0,_jquery.default)(document).on("click",".exaport-wp-viewExport, .exaport-wp-viewUpdate, .exaport-wp-viewRemove",(function(e){e.preventDefault(),(0,_jquery.default)(".exaport-wp-error").remove();var theButton=(0,_jquery.default)(this),viewId=theButton.attr("data-viewId"),data={viewId:viewId},action="viewExport",successMessage=strings.exported||"Exported";theButton.hasClass("exaport-wp-viewUpdate")?(action="viewUpdate",successMessage=strings.updated||"Updated"):theButton.hasClass("exaport-wp-viewRemove")&&(action="viewRemove",successMessage=strings.removed||"Removed"),buttonLoading(theButton,!0),wpRequest(action,data,(function(response){if((response=JSON.parse(response).response)&&response.success){if("viewRemove"==action){(0,_jquery.default)(".exaport-wp-viewPreview[data-viewId="+viewId+"]").addClass("d-none").attr("href","#"),(0,_jquery.default)(".exaport-wp-viewExport[data-viewId="+viewId+"]").removeClass("d-none"),(0,_jquery.default)(".exaport-wp-viewUpdate[data-viewId="+viewId+"]").addClass("d-none"),(0,_jquery.default)(".exaport-wp-viewRemove[data-viewId="+viewId+"]").addClass("d-none"),(iconWrapper=(0,_jquery.default)(".wp-exported-icons-wrapper[data-viewId="+viewId+"]")).find(".exaport-icon").addClass("d-none"),(0,_jquery.default)(".wp-exported-wptimemodified-wrapper[data-viewId="+viewId+"]").text("")}else{var viewButton=(0,_jquery.default)(".exaport-wp-viewPreview[data-viewId="+viewId+"]");viewButton.removeClass("d-none");var iconWrapper,href=response.view.shortUrl?response.view.shortUrl:response.view.url;viewButton.attr("href",href),(0,_jquery.default)(".exaport-wp-viewExport[data-viewId="+viewId+"]").addClass("d-none"),(0,_jquery.default)(".exaport-wp-viewUpdate[data-viewId="+viewId+"]").removeClass("d-none"),(0,_jquery.default)(".exaport-wp-viewRemove[data-viewId="+viewId+"]").removeClass("d-none"),(iconWrapper=(0,_jquery.default)(".wp-exported-icons-wrapper[data-viewId="+viewId+"]")).find(".exaport-icon").addClass("d-none"),iconWrapper.find(".exaport-icon.wp-exported").removeClass("d-none"),(0,_jquery.default)(".wp-exported-wptimemodified-wrapper[data-viewId="+viewId+"]").text(response.view.timemodified)}(0,_toast.add)(successMessage,{type:"success",autohide:!0})}response&&response.error&&(0,_toast.add)(response.message,{type:"danger",autohide:!1,closeButton:!0}),response||(0,_toast.add)(strings.request_error||"Request error!",{type:"danger",autohide:!1,closeButton:!0}),buttonLoading(theButton,!1)}),(function(){buttonLoading(theButton,!1),(0,_toast.add)(strings.request_error||"Request error!",{type:"danger",autohide:!1,closeButton:!0})}))})),(0,_jquery.default)(document).on("click",".exaport-wp-cvExport, .exaport-wp-cvUpdate, .exaport-wp-cvRemove",(function(e){e.preventDefault(),(0,_jquery.default)(".exaport-wp-error").remove();var theButton=(0,_jquery.default)(this),action="cvExport",successMessage=strings.exported||"Exported";theButton.hasClass("exaport-wp-cvUpdate")?(action="cvUpdate",successMessage=strings.updated||"Updated"):theButton.hasClass("exaport-wp-cvRemove")&&(action="cvRemove",successMessage=strings.removed||"Removed"),buttonLoading(theButton,!0),wpRequest(action,{},(function(response){if((response=JSON.parse(response).response)&&response.success){if("cvRemove"==action)(0,_jquery.default)(".exaport-wp-cv-info").addClass("d-none"),(0,_jquery.default)(".exaport-wp-cvExport").removeClass("d-none");else if("cvExport"==action){(0,_jquery.default)(".exaport-wp-cvExport").addClass("d-none"),(0,_jquery.default)(".exaport-wp-cv-info").removeClass("d-none"),(0,_jquery.default)(".exaport-wp-cv-info .date").text(response.cv.timemodified);var href=response.cv.shortUrl?response.cv.shortUrl:response.cv.url;(0,_jquery.default)(".exaport-wp-cv-info .exaport-wp-cvView").attr("href",href)}else{(0,_jquery.default)(".exaport-wp-cv-info .date").text(response.cv.timemodified);href=response.cv.shortUrl?response.cv.shortUrl:response.cv.url;(0,_jquery.default)(".exaport-wp-cv-info .exaport-wp-cvView").attr("href",href)}(0,_toast.add)(successMessage,{type:"success",autohide:!0})}response&&response.error&&(0,_toast.add)(response.message,{type:"danger",autohide:!1,closeButton:!0}),response||(0,_toast.add)(strings.request_error||"Request error!",{type:"danger",autohide:!1,closeButton:!0}),buttonLoading(theButton,!1)}),(function(){buttonLoading(theButton,!1),(0,_toast.add)(strings.request_error_code.replace("{$a}","1745230772232")||"Request error (code: 1745230772232)!",{type:"danger",autohide:!1,closeButton:!0})}))})),(0,_jquery.default)(document).on("click",".exaport-wp-profileRemove",(function(e){if(e.preventDefault(),(0,_jquery.default)(".exaport-wp-error").remove(),confirm("Are you sure you want to remove your entire WordPress profile?  This will delete all your data including CV and views and your Wordpress user itself.")){var theButton=(0,_jquery.default)(this),successMessage=strings.removed||"Removed";buttonLoading(theButton,!0),wpRequest("profileRemove",{},(function(response){(response=JSON.parse(response).response)&&response.success&&wpRequest("wpForm",[],(function(formHtml){(0,_jquery.default)(".exaport-wp-form").html(formHtml),(0,_toast.add)(successMessage,{type:"success",autohide:!0})})),response&&response.error&&(0,_toast.add)(response.message,{type:"danger",autohide:!1,closeButton:!0}),response||(0,_toast.add)(strings.request_error||"Request error!",{type:"danger",autohide:!1,closeButton:!0}),buttonLoading(theButton,!1)}),(function(){buttonLoading(theButton,!1),(0,_toast.add)(strings.request_error_code.replace("{$a}","1745590000010")||"Request error (code: 1745590000010)!",{type:"danger",autohide:!1,closeButton:!0})}))}}));var stringKeys},_jquery=_interopRequireDefault(_jquery),_config=_interopRequireDefault(_config);var strings={};function buttonLoading(button,isLoading){button.prop("disabled",isLoading),button.toggleClass("disabled",isLoading),button.find(".exaport-icon").toggleClass("fa-spin",isLoading)}function wpRequest(action,parameters,successFunction,failureFunction){var ajaxUrl=(0,_jquery.default)(".exaport-wp-form").attr("data-ajaxUrl");_jquery.default.ajax({url:ajaxUrl,type:"POST",data:{wp_action:action,parameters:parameters,sesskey:_config.default.sesskey},success:function(res){successFunction(res)},failure:function(res){failureFunction(res)}})}}));

//# sourceMappingURL=wordpress_export.min.js.map