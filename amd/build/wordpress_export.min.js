define("block_exaport/wordpress_export",["exports","jquery","core/toast","core/config"],(function(_exports,_jquery,_toast,_config){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function buttonLoading(button,isLoading){button.prop("disabled",isLoading),button.toggleClass("disabled",isLoading),button.find(".exaport-icon").toggleClass("fa-spin",isLoading)}function wpRequest(action,parameters,successFunction,failureFunction){var ajaxUrl=(0,_jquery.default)(".exaport-wp-form").attr("data-ajaxUrl");_jquery.default.ajax({url:ajaxUrl,type:"POST",data:{wp_action:action,parameters:parameters,sesskey:_config.default.sesskey},success:function(res){successFunction(res)},failure:function(res){failureFunction(res)}})}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=function(){(0,_jquery.default)(document).on("click",".exaport-wp-login, .exaport-wp-loginUpdate",(function(e){e.preventDefault(),(0,_jquery.default)(".exaport-wp-error").remove();var theButton=(0,_jquery.default)(this),action="login",successMessage="Logged in";theButton.hasClass("exaport-wp-loginUpdate")&&(action="loginUpdate",successMessage="Updated"),buttonLoading(theButton,!0),wpRequest(action,[],(function(response){buttonLoading(theButton,!1),(response=JSON.parse(response).response).success&&(wpRequest("wpForm",[],(function(response){theButton.closest("form").html(response)})),(0,_toast.add)(successMessage,{type:"success",autohide:!0})),response.error&&(0,_toast.add)(response.message,{type:"danger",autohide:!1,closeButton:!0})}),(function(){buttonLoading(theButton,!1),(0,_toast.add)("Error: 1745225660311",{type:"danger",autohide:!1,closeButton:!0})}))})),(0,_jquery.default)(document).on("click",".exaport-wp-viewExport, .exaport-wp-viewUpdate, .exaport-wp-viewRemove",(function(e){e.preventDefault(),(0,_jquery.default)(".exaport-wp-error").remove();var theButton=(0,_jquery.default)(this),viewId=theButton.attr("data-viewId"),data={viewId:viewId},action="viewExport",successMessage="Exported";if(theButton.hasClass("exaport-wp-viewUpdate")){action="viewUpdate";successMessage="Updated"}else if(theButton.hasClass("exaport-wp-viewRemove")){action="viewRemove";successMessage="Removed"}buttonLoading(theButton,!0),wpRequest(action,data,(function(response){if((response=JSON.parse(response).response)&&response.success){if("viewRemove"==action){(0,_jquery.default)(".exaport-wp-viewPreview[data-viewId="+viewId+"]").addClass("d-none").attr("href","#"),(0,_jquery.default)(".exaport-wp-viewExport[data-viewId="+viewId+"]").removeClass("d-none"),(0,_jquery.default)(".exaport-wp-viewUpdate[data-viewId="+viewId+"]").addClass("d-none"),(0,_jquery.default)(".exaport-wp-viewRemove[data-viewId="+viewId+"]").addClass("d-none"),(iconWrapper=(0,_jquery.default)(".wp-exported-icons-wrapper[data-viewId="+viewId+"]")).find(".exaport-icon").addClass("d-none"),(0,_jquery.default)(".wp-exported-wptimemodified-wrapper[data-viewId="+viewId+"]").text("")}else{var iconWrapper,viewButton=(0,_jquery.default)(".exaport-wp-viewPreview[data-viewId="+viewId+"]");viewButton.removeClass("d-none"),viewButton.attr("href",response.view.url),(0,_jquery.default)(".exaport-wp-viewExport[data-viewId="+viewId+"]").addClass("d-none"),(0,_jquery.default)(".exaport-wp-viewUpdate[data-viewId="+viewId+"]").removeClass("d-none"),(0,_jquery.default)(".exaport-wp-viewRemove[data-viewId="+viewId+"]").removeClass("d-none"),(iconWrapper=(0,_jquery.default)(".wp-exported-icons-wrapper[data-viewId="+viewId+"]")).find(".exaport-icon").addClass("d-none"),iconWrapper.find(".exaport-icon.wp-exported").removeClass("d-none"),(0,_jquery.default)(".wp-exported-wptimemodified-wrapper[data-viewId="+viewId+"]").text(response.view.timemodified)}(0,_toast.add)(successMessage,{type:"success",autohide:!0})}response&&response.error&&(0,_toast.add)(response.message,{type:"danger",autohide:!1,closeButton:!0}),response||(0,_toast.add)("Request error!",{type:"danger",autohide:!1,closeButton:!0}),buttonLoading(theButton,!1)}),(function(){buttonLoading(theButton,!1),(0,_toast.add)("Request error!",{type:"danger",autohide:!1,closeButton:!0})}))})),(0,_jquery.default)(document).on("click",".exaport-wp-cvExport, .exaport-wp-cvUpdate, .exaport-wp-cvRemove",(function(e){e.preventDefault(),(0,_jquery.default)(".exaport-wp-error").remove();var theButton=(0,_jquery.default)(this),action="cvExport",successMessage="Exported";if(theButton.hasClass("exaport-wp-cvUpdate")){action="cvUpdate";successMessage="Updated"}else if(theButton.hasClass("exaport-wp-cvRemove")){action="cvRemove";successMessage="Removed"}buttonLoading(theButton,!0),wpRequest(action,{},(function(response){(response=JSON.parse(response).response)&&response.success&&("cvRemove"==action?((0,_jquery.default)(".exaport-wp-cv-info").addClass("d-none"),(0,_jquery.default)(".exaport-wp-cvExport").removeClass("d-none")):"cvExport"==action?((0,_jquery.default)(".exaport-wp-cvExport").addClass("d-none"),(0,_jquery.default)(".exaport-wp-cv-info").removeClass("d-none"),(0,_jquery.default)(".exaport-wp-cv-info .date").text(response.cv.timemodified),(0,_jquery.default)(".exaport-wp-cv-info .exaport-wp-cvView").attr("href",response.cv.url)):((0,_jquery.default)(".exaport-wp-cv-info .date").text(response.cv.timemodified),(0,_jquery.default)(".exaport-wp-cv-info .exaport-wp-cvView").attr("href",response.cv.url)),(0,_toast.add)(successMessage,{type:"success",autohide:!0})),response&&response.error&&(0,_toast.add)(response.message,{type:"danger",autohide:!1,closeButton:!0}),response||(0,_toast.add)("Request error!",{type:"danger",autohide:!1,closeButton:!0}),buttonLoading(theButton,!1)}),(function(){buttonLoading(theButton,!1),(0,_toast.add)("Request error (code: 1745230772232)!",{type:"danger",autohide:!1,closeButton:!0})}))}))},_jquery=_interopRequireDefault(_jquery),_config=_interopRequireDefault(_config)}));

//# sourceMappingURL=wordpress_export.min.js.map